<!doctype html>
<html ng-app="hmTime">
  <head>
    <style type="text/css">
      html, body {
        background-color: #d1c9b8;
        width: 100%;
        height: 100%;
      }

      .relpos {
        position: relative;
      }

      #target {
        left: 0;
        top: 0;
        width: 500px;
        height: 500px;
        vertical-align: middle;
        text-align: center;
        color: white;
        background-color: #444;
        font-size: 36pt;
        font-family: 'Futura', 'Avenir', 'Helvetica', sans-serif;
      }
    </style>
  </head>
  <body>
    <div ng-controller="hmCtrl" hm-dir="hm-dir" class="relpos"></div>
    <script type="text/javascript" src="../bower_components/hammerjs/hammer.min.js"></script>
    <script type="text/javascript" src="../bower_components/angular/angular.min.js"></script>
    <script type="text/javascript" src="../angular.hammer.js"></script>
    <script type="text/javascript">
      /**
       * @ngInject
       */
      angular.module('hmTime', ['hmTouchEvents'])
        .controller('hmCtrl', function ($scope) {
          $scope.eventType = "Drag me around!";
        })
        .directive('hmDir', function () {
          return {
            'restrict' : 'AE',
            'template' : '<div id="target" hm-pan-move="onHammer">{{eventType}}</div>',
            'link' : function (scope, element, attrs) {
              var x, y;

              scope.onHammer = function onHammer (event) {
                console.log(event.target, element)
                if (event.target === element[0].children[0]) {
                  if (!x) { x = event.center.x; }
                  if (!y) { y = event.center.y; }

                  scope.$apply(function () {
                    x = event.center.x - 250;
                    y = event.center.y - 250;

                    element.css({
                      'left' : x + 'px',
                      'top' : y + 'px'
                    });
                  });
                }
              };
            }
          }
        });
    </script>
  </body>
</html>